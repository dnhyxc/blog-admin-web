var A=(b,p,l)=>new Promise((h,S)=>{var w=d=>{try{m(l.next(d))}catch(v){S(v)}},y=d=>{try{m(l.throw(d))}catch(v){S(v)}},m=d=>d.done?h(d.value):Promise.resolve(d.value).then(w,y);m((l=l.apply(b,p)).next())});import{_ as Q}from"./index-9942da33.js";import{d as W,aJ as i,aK as X,T as E,b3 as Y,b4 as ee,b5 as te,bk as ae,bl as oe,o as c,j as R,w as s,g as f,i as o,aU as u,A as T,f as g,h as _,b7 as se,B as le,l as ne,C as ie,D as ue,_ as de}from"./index-c3904695.js";/* empty css                 *//* empty css                 *//* empty css                 *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                    *//* empty css                  */import"./el-tooltip-4ed993c7.js";import{e as n,u as re}from"./index-fe386976.js";import{f as ce}from"./index-11a757ea.js";import{M as _e}from"./index-31e04a31.js";import{M as pe}from"./index-cf4ffd93.js";/* empty css                   *//* empty css                   *//* empty css                */const V=b=>(ie("data-v-1cef2151"),b=b(),ue(),b),me={class:"action-btn"},ve={class:"content"},ge={class:"username"},fe={key:0,class:"auth"},he={key:1,class:"auth"},be={key:2,class:"auth"},ye={key:3,class:"auth"},ke=["title"],we={key:0},Se=V(()=>f("span",{class:"status-del"},null,-1)),Ce={key:1},Ae=V(()=>f("span",{class:"status-use"},null,-1)),Ie={class:"actions"},De={key:0},Ue={key:1},xe={class:"footer"},Ee=W({__name:"index",setup(b){const p=i(),l=i([]),h=i(1),S=i(!1),w=i(!1),y=i(!1),m=i(1),d=i(""),v=i([]),I=i(""),D=i(0);X(()=>{U()});const U=()=>{var e;n.getAdminUserList({pageNo:h.value,pageSize:E,userId:(e=re)==null?void 0:e.userId})},N=e=>{l.value=e},B=e=>{const{id:t,isDelete:r}=e;r?P(t):M(t)},M=e=>{n.manageAccount({userIds:[e],type:1}),p.value.clearSelection()},P=e=>{n.manageAccount({userIds:[e],type:0}),p.value.clearSelection()},z=()=>{const e=l.value.filter(t=>!t.isDelete).map(t=>t.id);n.manageAccount({userIds:e,type:1}),p.value.clearSelection()},G=()=>{const e=l.value.filter(t=>t.isDelete).map(t=>t.id);n.manageAccount({userIds:e,type:0}),p.value.clearSelection()},L=e=>{const{id:t}=e;d.value=t,y.value=!0},$=()=>{const e=l.value.map(t=>t.id);v.value=e,y.value=!0},j=()=>A(this,null,function*(){yield n.deleteAdminUsers({userIds:v.value.length?v.value:[d.value],pageNo:h.value}),v.value=[],p.value.clearSelection()}),F=e=>{const{id:t,auth:r}=e;I.value=t,D.value=r,w.value=!0},H=e=>{m.value=e},J=()=>A(this,null,function*(){return yield n.setAdminUserAuth({userId:I.value,auth:m.value})}),K=e=>{h.value=e,U()};return(e,t)=>{const r=Y,k=ee,O=te,C=ae,Z=oe,q=Q;return c(),R(q,{loading:_(n).loading,class:"users-wrap"},{default:s(()=>[f("div",me,[o(r,{type:"warning",disabled:!l.value.length,onClick:z},{default:s(()=>[u("批量作废")]),_:1},8,["disabled"]),o(r,{type:"primary",disabled:!l.value.length,onClick:G},{default:s(()=>[u("批量恢复")]),_:1},8,["disabled"]),o(r,{type:"danger",disabled:!l.value.length,onClick:$},{default:s(()=>[u("批量删除")]),_:1},8,["disabled"])]),f("div",ve,[o(_(se),{ref_key:"multipleTableRef",ref:p,data:_(n).list,style:{width:"100%"},onSelectionChange:N},{default:s(()=>[o(k,{type:"selection",width:"55"}),o(k,{label:"用户名","show-overflow-tooltip":""},{default:s(a=>[f("div",ge,T(a.row.username),1)]),_:1}),o(k,{property:"auth",label:"权限"},{default:s(a=>[a.row.auth===0?(c(),g("div",fe,"普通用户")):a.row.auth===1?(c(),g("div",he,"超级管理员")):a.row.auth===2?(c(),g("div",be,"管理员")):(c(),g("div",ye,"普通用户"))]),_:1}),o(k,{property:"registerTime",label:"注册时间"},{default:s(a=>[u(T(_(ce)(a.row.registerTime)),1)]),_:1}),o(k,{property:"status",label:"账号状态"},{default:s(a=>[f("div",{class:"status",title:a.row.isDelete?"已作废":"使用中"},[a.row.isDelete?(c(),g("span",we,[Se,u("已作废")])):(c(),g("span",Ce,[Ae,u("使用中")]))],8,ke)]),_:1}),o(k,{fixed:"right",label:"操作",width:"175"},{default:s(a=>[f("div",Ie,[o(r,{link:"",type:"primary",onClick:x=>F(a.row)},{default:s(()=>[u("权限设置")]),_:2},1032,["onClick"]),o(r,{link:"",type:a.row.isDelete?"primary":"warning",onClick:x=>B(a.row)},{default:s(()=>[a.row.isDelete?(c(),g("span",Ue,"恢复")):(c(),g("span",De,"作废"))]),_:2},1032,["type","onClick"]),o(r,{link:"",type:"danger",onClick:x=>L(a.row)},{default:s(()=>[u("删除")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),f("div",xe,[o(O,{"current-page":h.value,"onUpdate:current-page":t[0]||(t[0]=a=>h.value=a),"page-size":_(E),background:"",disabled:S.value,layout:"total, prev, pager, next",total:_(n).total,"hide-on-single-page":_(n).list.length<=_(n).total,onCurrentChange:K},null,8,["current-page","page-size","disabled","total","hide-on-single-page"])])]),o(_e,{visible:w.value,"onUpdate:visible":t[2]||(t[2]=a=>w.value=a),"on-submit":J,title:"权限设置"},{default:s(()=>[o(Z,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a),onChange:H},{default:s(()=>[o(C,{label:1},{default:s(()=>[u("超级管理员")]),_:1}),D.value!==_(le).SUPER?(c(),R(C,{key:0,label:2},{default:s(()=>[u("管理员")]),_:1})):ne("",!0),o(C,{label:0},{default:s(()=>[u("普通用户")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["visible"]),o(pe,{visible:y.value,"onUpdate:visible":t[3]||(t[3]=a=>y.value=a),title:"账号删除",content:"确定删除该账号吗？","on-submit":j},null,8,["visible"])]),_:1},8,["loading"])}}});const Qe=de(Ee,[["__scopeId","data-v-1cef2151"]]);export{Qe as default};
