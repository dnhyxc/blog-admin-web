var _=(y,h,u)=>new Promise((p,c)=>{var d=m=>{try{f(u.next(m))}catch(g){c(g)}},a=m=>{try{f(u.throw(m))}catch(g){c(g)}},f=m=>m.done?p(m.value):Promise.resolve(m.value).then(d,a);f((u=u.apply(y,h)).next())});import{d as A,u as D,aI as J,aJ as C,bb as $,aK as M,bB as q,b2 as G,bd as H,be as O,b3 as Q,bf as W,o as E,f as P,g as w,i as s,w as r,bg as V,aU as v,l as I,C as X,D as Y,_ as Z}from"./index-c3904695.js";/* empty css                     *//* empty css                  *//* empty css                 */import{v as ee,e as se,h as oe,i as te,j as ae}from"./index-11a757ea.js";const K=y=>(X("data-v-6661c7e4"),y=y(),Y(),y),re={class:"login"},le={class:"content"},ne=K(()=>w("div",{class:"content-left"},null,-1)),ie={key:0,class:"content-right"},de=K(()=>w("div",{class:"title"},"账号密码登录",-1)),ue={class:"reset-wrap"},me={key:1,class:"content-right"},ce=K(()=>w("div",{class:"title"},"账号注册",-1)),fe={class:"reset-wrap"},pe={key:2,class:"content-right"},ve=K(()=>w("div",{class:"title"},"账号密码登录",-1)),we=A({__name:"index",setup(y){const h=D(),u=J(),p=C(!1),c=C(!1),d=C(),a=$({username:"",password:"",confirmPwd:"",code:""}),f=C(null),m=C(""),g=120,b=40,U=$({username:[{validator:(o,e,t)=>{const{msg:n,status:i}=ee(e);e===""?t(new Error("用户名不能为空")):i?t():t(new Error(n))},trigger:"blur",required:!0}],password:[{validator:(o,e,t)=>{const{msg:n,status:i}=se(e);e===""?t(new Error("密码不能为空")):i?t():t(new Error(n))},trigger:"blur",required:!0}],confirmPwd:[{validator:(o,e,t)=>{const{msg:n,status:i}=oe(e,a.password);e===""?t(new Error("确认密码不能为空")):i?t():t(new Error(n))},trigger:"blur",required:!0}],code:[{validator:(o,e,t)=>{const{msg:n,status:i}=te(e,m.value);e===""?t(new Error("验证码不能为空")):i?t():t(new Error(n))},trigger:"blur",required:!0}]}),x=o=>{m.value=ae({canvasElement:o,width:g,height:b,code:u.verifyCode.code})};M(()=>_(this,null,function*(){yield u.getVerifyCode(),q(()=>{x(f.value)})})),G([c,p],o=>{!o[0]&&!o[1]&&q(()=>{x(f.value)})});const k=()=>_(this,null,function*(){yield u.getVerifyCode(),f.value&&(m.value="",x(f.value))}),N=o=>{o&&o.validate(e=>_(this,null,function*(){if(e){const t=yield u.onLogin(a,k);t!=null&&t.success&&h.push("/home")}else return!1}))},B=o=>{o&&o.validate(e=>_(this,null,function*(){if(e)yield u.onRegister(a),p.value=!1;else return!1}))},F=()=>{d.value&&d.value.validate(o=>_(this,null,function*(){if(o){const e=yield u.onLogin(a,k);e!=null&&e.success&&h.push("/home")}else return!1}))},T=()=>{R()},R=()=>{d.value&&d.value.validate(o=>_(this,null,function*(){if(o){const e=yield u.onResetPwd(a);e!=null&&e.success&&(p.value=!1,c.value=!1)}else return!1}))},L=o=>{o||k(),p.value=o},S=()=>{var o;c.value=!0,(o=d.value)==null||o.resetFields(["password"])},j=()=>{var o;c.value=!1,(o=d.value)==null||o.resetFields(["password","confirmPwd"])};return(o,e)=>{const t=H,n=O,i=Q,z=W;return E(),P("div",re,[w("div",le,[ne,!c.value&&!p.value?(E(),P("div",ie,[de,s(z,{ref_key:"formRef",ref:d,rules:U,model:a,class:"form-wrap"},{default:r(()=>[s(n,{prop:"username",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l),size:"large",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s(n,{prop:"password",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=l=>a.password=l),size:"large",placeholder:"请输入密码","show-password":"",onKeyup:V(F,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(n,{prop:"code",class:"form-item code-item"},{default:r(()=>[s(t,{modelValue:a.code,"onUpdate:modelValue":e[2]||(e[2]=l=>a.code=l),size:"large",class:"code-inp",placeholder:"请输入验证码",onKeyup:V(F,["enter"])},null,8,["modelValue","onKeyup"]),w("canvas",{ref_key:"canvasCtx",ref:f,class:"code-canvas",width:g,height:b,onClick:k},null,512)]),_:1}),s(n,{class:"form-item action-list"},{default:r(()=>[s(i,{type:"primary",size:"large",class:"action",onClick:e[3]||(e[3]=l=>N(d.value))},{default:r(()=>[v("用户登录")]),_:1})]),_:1})]),_:1},8,["rules","model"]),w("div",ue,[s(i,{class:"action",type:"primary",link:"",onClick:e[4]||(e[4]=l=>L(!0))},{default:r(()=>[v("没有账号，前往注册")]),_:1}),s(i,{class:"action",type:"primary",link:"",onClick:S},{default:r(()=>[v("忘记密码")]),_:1})])])):I("",!0),p.value?(E(),P("div",me,[ce,s(z,{ref_key:"formRef",ref:d,rules:U,model:a,class:"form-wrap"},{default:r(()=>[s(n,{prop:"username",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.username,"onUpdate:modelValue":e[5]||(e[5]=l=>a.username=l),size:"large",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s(n,{prop:"password",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.password,"onUpdate:modelValue":e[6]||(e[6]=l=>a.password=l),size:"large",placeholder:"请输入密码","show-password":"",onKeyup:e[7]||(e[7]=V(l=>B(d.value),["enter"]))},null,8,["modelValue"])]),_:1}),s(n,{class:"form-item action-list"},{default:r(()=>[s(i,{class:"action",type:"primary",size:"large",onClick:e[8]||(e[8]=l=>B(d.value))},{default:r(()=>[v("账号注册")]),_:1})]),_:1})]),_:1},8,["rules","model"]),w("div",fe,[s(i,{class:"action",type:"primary",link:"",onClick:e[9]||(e[9]=l=>L(!1))},{default:r(()=>[v("已有账号，前往登录")]),_:1}),s(i,{class:"action",type:"primary",link:"",onClick:S},{default:r(()=>[v("忘记密码")]),_:1})])])):I("",!0),c.value?(E(),P("div",pe,[ve,s(z,{ref_key:"formRef",ref:d,rules:U,model:a,class:"form-wrap"},{default:r(()=>[s(n,{prop:"username",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.username,"onUpdate:modelValue":e[10]||(e[10]=l=>a.username=l),size:"large",placeholder:"请输入用户名",onKeyup:V(R,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(n,{prop:"password",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.password,"onUpdate:modelValue":e[11]||(e[11]=l=>a.password=l),size:"large",placeholder:"请输入新密码","show-password":"",onKeyup:V(R,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(n,{prop:"confirmPwd",class:"form-item"},{default:r(()=>[s(t,{modelValue:a.confirmPwd,"onUpdate:modelValue":e[12]||(e[12]=l=>a.confirmPwd=l),size:"large",placeholder:"请输入二次确认密码","show-password":"",onKeyup:V(R,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(n,{class:"form-item action-list"},{default:r(()=>[s(i,{type:"primary",size:"large",class:"action",onClick:T},{default:r(()=>[v("确认重置")]),_:1}),s(i,{class:"action",size:"large",onClick:j},{default:r(()=>[v("返回登录")]),_:1})]),_:1})]),_:1},8,["rules","model"])])):I("",!0)])])}}});const Ke=Z(we,[["__scopeId","data-v-6661c7e4"]]);export{Ke as default};
