var v=(I,g,u)=>new Promise((C,k)=>{var w=a=>{try{d(u.next(a))}catch(r){k(r)}},_=a=>{try{d(u.throw(a))}catch(r){k(r)}},d=a=>a.done?C(a.value):Promise.resolve(a.value).then(w,_);d((u=u.apply(I,g)).next())});import{d as Q,c as F,aJ as b,bb as Y,aK as Z,aW as ee,b3 as se,bc as te,bd as oe,be as ae,bf as le,aX as ne,o as i,j as L,w as l,h as n,f,g as m,l as p,i as c,aM as ie,F as re,r as ce,A as x,b6 as N,aU as T,B as de,bg as ue,b0 as _e,_ as fe}from"./index-c3904695.js";import"./el-infinite-scroll-4ed993c7.js";import{_ as me}from"./index-9942da33.js";import{M as pe}from"./index-cf4ffd93.js";import{M as ye}from"./index-31e04a31.js";/* empty css                     *//* empty css                 */import{_ as ve}from"./index-09de227e.js";/* empty css                     *//* empty css                  */import{s as be}from"./index-11a757ea.js";import{u as ge}from"./index-cfc8d944.js";import{d as o,u as M}from"./index-fe386976.js";import{_ as Ce}from"./index-fa24d2d2.js";/* empty css                   *//* empty css                   *//* empty css                */const ke={key:0,class:"create"},we=["infinite-scroll-disabled"],he={class:"title"},xe={class:"desc"},Me={class:"action"},Se={key:1,class:"loading"},Le={key:2,class:"no-more"},Ne={class:"modal-content"},Ie=Q({__name:"index",setup(I){const{scrollRef:g,scrollTop:u}=ge(),C=F(()=>{const{classifyList:t,total:e}=o;return t.length>=e&&t.length}),k=F(()=>o.loading||C.value),w=b(!1),_=b(!1),d=b(!1),a=b(""),r=b(),h=Y({classifyName:""});Z(()=>{w.value=!0,o.getClassifyList()}),ee(()=>{o.clearClassifyList()});const B=()=>{o.getClassifyList()},S=t=>{var e,y;return(y=t==null?void 0:t.addUserIds)==null?void 0:y.includes((e=M)==null?void 0:e.userId)},R=()=>{_.value=!0},E=()=>{r.value&&r.value.validate(t=>v(this,null,function*(){var e;if(t)yield o.createClassify(h.classifyName),_.value=!1,(e=r.value)==null||e.resetFields(),o.clearClassifyList(),o.getClassifyList();else return!1}))},A=(t,e)=>v(this,null,function*(){e?yield o.addClassify(t,"remove"):yield o.addClassify(t,"add")}),D=t=>v(this,null,function*(){a.value=t.id,d.value=!0}),K=()=>v(this,null,function*(){yield o.deleteClassify(a.value)}),$=()=>{be(g,0)};return(t,e)=>{const y=se,O=te,j=ve,q=oe,z=ae,G=le,H=ye,J=pe,P=me,W=ne;return i(),L(P,{loading:n(o).loading,class:"tag-list-wrap"},{default:l(()=>{var U,V;return[((U=n(M))==null?void 0:U.auth)===1?(i(),f("div",ke,[m("div",{class:"create-btn",onClick:R},"创建新分类")])):p("",!0),m("div",{class:_e(`tag-list ${((V=n(M))==null?void 0:V.auth)!==1&&"notAuth"}`)},[c(O,{ref_key:"scrollRef",ref:g,class:"infinite-list-wrapper"},{default:l(()=>[w.value?ie((i(),f("div",{key:0,class:"list","infinite-scroll-disabled":n(k),"infinite-scroll-immediate":"","infinite-scroll-distance":"2"},[(i(!0),f(re,null,ce(n(o).classifyList,s=>(i(),f("div",{key:s.id,class:"card-wrap"},[c(Ce,{class:"card"},{title:l(()=>[m("div",he,x(s.classifyName||"-"),1)]),content:l(()=>[m("div",xe,x(s.userCount)+" 添加   "+x(s.articleCount)+" 文章",1)]),footer:l(()=>[m("div",Me,[c(y,{type:S(s)?"warning":"primary",link:"",class:"add-btn",onClick:N(X=>A(s.id,S(s)),["stop"])},{default:l(()=>[T(x(S(s)?"移除分类":"添加分类"),1)]),_:2},1032,["type","onClick"]),n(M).auth===n(de).SUPER?(i(),L(y,{key:0,type:"danger",link:"",class:"add-btn",onClick:N(X=>D(s),["stop"])},{default:l(()=>[T("删除")]),_:2},1032,["onClick"])):p("",!0)])]),_:2},1024)]))),128))],8,we)),[[W,B]]):p("",!0),n(o).loading?(i(),f("p",Se,"Loading...")):p("",!0),n(C)?(i(),f("p",Le,"没有更多了～～～")):p("",!0)]),_:1},512),n(u)>=500?(i(),L(j,{key:0,"on-scroll-to":$})):p("",!0),c(H,{visible:_.value,"onUpdate:visible":e[2]||(e[2]=s=>_.value=s),title:"创建分类",width:450,"content-padding":"10px","on-submit":E},{default:l(()=>[m("div",Ne,[c(G,{ref_key:"formRef",ref:r,model:h,"label-width":"110px",class:"form-wrap",onSubmit:e[1]||(e[1]=N(()=>{},["prevent"]))},{default:l(()=>[c(z,{label:"分类名称","label-width":"80px",rules:{required:!0,message:"请输入分类名称"},class:"form-item-custom",onKeyup:ue(E,["enter"])},{default:l(()=>[c(q,{modelValue:h.classifyName,"onUpdate:modelValue":e[0]||(e[0]=s=>h.classifyName=s),placeholder:"请输入需要绑定的前台账号名称"},null,8,["modelValue"])]),_:1},8,["onKeyup"])]),_:1},8,["model"])])]),_:1},8,["visible"]),c(J,{visible:d.value,"onUpdate:visible":e[3]||(e[3]=s=>d.value=s),title:"删除文章",content:"确定删除该文章吗？",info:"删除文章后，该文章将无法恢复！","on-submit":K},null,8,["visible"])],2)]}),_:1},8,["loading"])}}});const Pe=fe(Ie,[["__scopeId","data-v-eddaf267"]]);export{Pe as default};
