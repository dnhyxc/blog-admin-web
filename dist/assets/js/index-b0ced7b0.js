var v=(w,b,i)=>new Promise((h,A)=>{var C=_=>{try{m(i.next(_))}catch(g){A(g)}},y=_=>{try{m(i.throw(_))}catch(g){A(g)}},m=_=>_.done?h(_.value):Promise.resolve(_.value).then(C,y);m((i=i.apply(w,b)).next())});import{_ as ae}from"./index-9942da33.js";import{d as le,aJ as u,aK as oe,T as E,b3 as se,b4 as ne,bj as ie,b5 as re,bk as de,bl as ce,bm as ue,bn as _e,bc as pe,o as k,j as U,w as o,g as s,i as l,aU as p,h as r,b7 as me,A as f,f as T,B as ve,l as be,r as he,bo as x,F as ge,C as fe,D as we,_ as ye}from"./index-c3904695.js";/* empty css                     *//* empty css                    *//* empty css                 *//* empty css                 *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                  */import"./el-tooltip-4ed993c7.js";import{a as d,u as ke}from"./index-fe386976.js";import{f as R}from"./index-11a757ea.js";import{M as Ce}from"./index-31e04a31.js";import{M as Se}from"./index-cf4ffd93.js";/* empty css                   *//* empty css                   *//* empty css                */const I=w=>(fe("data-v-9d620294"),w=w(),we(),w),xe={class:"action-btn"},Ae={class:"username"},Ie={class:"img"},De=["title"],Ee={class:"status"},Ue=["title"],Te=["title"],Ve=["title"],Me={class:"desc"},Ne=["title"],Re={class:"status"},je={key:0},Be=I(()=>s("span",{class:"status-del"},null,-1)),Ge={key:1},Le=I(()=>s("span",{class:"status-use"},null,-1)),Pe={class:"actions"},ze={class:"footer"},Fe={class:"account-auth"},$e=I(()=>s("div",{class:"title"},"账号权限",-1)),Oe={class:"menu-auth"},He=I(()=>s("div",{class:"title"},"菜单权限",-1)),Je=le({__name:"index",setup(w){const b=u(),i=u([]),h=u(1),A=u(!1),C=u(!1),y=u(!1),m=u(1),_=u(""),g=u([]),V=u(""),S=u([x[0].name]);oe(()=>{D()});const D=()=>v(this,null,function*(){return yield d.getAccountList({pageNo:h.value,pageSize:E})}),j=a=>{i.value=a},B=a=>{m.value=a},G=a=>v(this,null,function*(){m.value=a.auth||0;const t=yield d.getUserMenuRoles(a==null?void 0:a.id);if(t!=null&&t.length){const c=x.filter(n=>t.includes(n.key)).map(n=>n.name);S.value=c}else S.value=[x[0].name];V.value=a.id,C.value=!0}),L=()=>v(this,null,function*(){const a=x.filter(t=>S.value.includes(t.name)).map(t=>t.key);return yield d.setAuth({auth:m.value,userId:V.value,menus:a}),h.value=1,D()}),P=a=>{const{isDelete:t,id:c}=a;t?z(c):F(c)},z=a=>v(this,null,function*(){yield d.manageAccount({userIds:[a],type:0}),b.value.clearSelection()}),F=a=>v(this,null,function*(){yield d.manageAccount({userIds:[a],type:1}),b.value.clearSelection()}),$=a=>{const{id:t}=a;_.value=t,y.value=!0},O=()=>v(this,null,function*(){yield d.batchDeleteUser({userIds:g.value.length?g.value:[_.value],pageNo:h.value}),g.value=[],b.value.clearSelection()}),H=()=>{const a=i.value.map(t=>t.id)||[];g.value=a,y.value=!0},J=()=>v(this,null,function*(){const a=i.value.filter(t=>!t.isDelete).map(t=>t.id)||[];yield d.manageAccount({userIds:a,type:1}),b.value.clearSelection()}),K=()=>v(this,null,function*(){const a=i.value.filter(t=>t.isDelete).map(t=>t.id)||[];yield d.manageAccount({userIds:a,type:0}),b.value.clearSelection()}),Z=a=>{h.value=a,D()};return(a,t)=>{const c=se,n=ne,q=ie,Q=re,M=de,W=ce,X=ue,Y=_e,ee=pe,te=ae;return k(),U(te,{loading:r(d).loading,class:"home-wrap"},{default:o(()=>[s("div",xe,[l(c,{type:"warning",disabled:!i.value.length,onClick:J},{default:o(()=>[p("批量作废")]),_:1},8,["disabled"]),l(c,{type:"primary",disabled:!i.value.length,onClick:K},{default:o(()=>[p("批量恢复")]),_:1},8,["disabled"]),l(c,{type:"danger",disabled:!i.value.length,onClick:H},{default:o(()=>[p("批量删除")]),_:1},8,["disabled"])]),l(ee,{class:"article-list-wrap"},{default:o(()=>[l(r(me),{ref_key:"multipleTableRef",ref:b,data:r(d).list,style:{width:"100%"},onSelectionChange:j},{default:o(()=>[l(n,{fixed:"left",type:"selection",width:"39"}),l(n,{label:"用户名","show-overflow-tooltip":"",width:"200"},{default:o(e=>[s("div",Ae,[s("div",Ie,[l(q,{class:"avatar",size:50,fit:"fill",src:e.row.headUrl},null,8,["src"])]),s("div",{class:"name",title:e.row.username},f(e.row.username),9,De)])]),_:1}),l(n,{property:"isDelete",label:"角色",width:"120"},{default:o(e=>[s("div",Ee,f(e.row.auth===1?"超级管理员":"普通用户"),1)]),_:1}),l(n,{property:"registerTime",label:"注册时间",width:"180"},{default:o(e=>[s("div",{class:"registerTime",title:r(R)(e.row.registerTime)},f(r(R)(e.row.registerTime)),9,Ue)]),_:1}),l(n,{property:"job",label:"职位",width:"150"},{default:o(e=>[s("div",{class:"job",title:e.row.job},f(e.row.job||"-"),9,Te)]),_:1}),l(n,{property:"introduce",label:"个人介绍",width:"300"},{default:o(e=>[s("div",{class:"introduce",title:e.row.introduce},[s("div",Me,f(e.row.introduce||"-"),1)],8,Ve)]),_:1}),l(n,{property:"motto",label:"座右铭",width:"200"},{default:o(e=>[s("div",{class:"motto",title:e.row.motto},f(e.row.motto||"-"),9,Ne)]),_:1}),l(n,{fixed:"right",property:"isDelete",label:"账号状态",width:"100"},{default:o(e=>[s("div",Re,[e.row.isDelete?(k(),T("span",je,[Be,p("已作废")])):(k(),T("span",Ge,[Le,p("使用中")]))])]),_:1}),l(n,{fixed:"right",label:"操作",width:"175"},{default:o(e=>[s("div",Pe,[l(c,{link:"",type:"primary",onClick:N=>G(e.row)},{default:o(()=>[p("权限设置")]),_:2},1032,["onClick"]),l(c,{link:"",type:e.row.isDelete?"primary":"warning",onClick:N=>P(e.row)},{default:o(()=>[p(f(e.row.isDelete?"恢复":"作废"),1)]),_:2},1032,["type","onClick"]),l(c,{link:"",type:"danger",onClick:N=>$(e.row)},{default:o(()=>[p("删除")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),s("div",ze,[l(Q,{"current-page":h.value,"onUpdate:current-page":t[0]||(t[0]=e=>h.value=e),"page-size":r(E),background:"",disabled:A.value,layout:"total, prev, pager, next",total:r(d).total,"hide-on-single-page":r(d).total<=r(E),onCurrentChange:Z},null,8,["current-page","page-size","disabled","total","hide-on-single-page"])]),l(Ce,{visible:C.value,"onUpdate:visible":t[3]||(t[3]=e=>C.value=e),"on-submit":L,title:"权限设置"},{default:o(()=>[s("div",Fe,[$e,l(W,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onChange:B},{default:o(()=>{var e;return[((e=r(ke))==null?void 0:e.auth)===r(ve).SUPER?(k(),U(M,{key:0,label:1},{default:o(()=>[p("设置为博主")]),_:1})):be("",!0),l(M,{label:0},{default:o(()=>[p("设置为普通用户")]),_:1})]}),_:1},8,["modelValue"])]),s("div",Oe,[He,l(Y,{modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=e=>S.value=e)},{default:o(()=>[(k(!0),T(ge,null,he(r(x),e=>(k(),U(X,{key:e.key,label:e.name},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["visible"]),l(Se,{visible:y.value,"onUpdate:visible":t[4]||(t[4]=e=>y.value=e),title:"账号删除",content:"确定删除该账号吗？","on-submit":O},null,8,["visible"])]),_:1})]),_:1},8,["loading"])}}});const pt=ye(Je,[["__scopeId","data-v-9d620294"]]);export{pt as default};
